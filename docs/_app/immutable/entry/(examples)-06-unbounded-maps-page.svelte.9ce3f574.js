var w=Object.defineProperty;var h=(s,e,n)=>e in s?w(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var A=(s,e,n)=>(h(s,typeof e!="symbol"?e+"":e,n),n);import{S as E,i as Q,s as b,I as L,ac as k}from"../chunks/index.9fe14626.js";import{d as a,g as u,s as I}from"../chunks/store.96cf5894.js";import{d as v}from"../chunks/index.7100d5a9.js";const D=`# Unbounded Maps - Simplified Token

In general, inifinite data structures that can actually grow to billions of elements are very difficult to implement on blockchain. As the contract persistent state grows in size, read and write operations become more expensive in gas. In the extreme, they may cost more than a transaction gas limit, rendering the contract unusable.

**It is therefore important to design contracts to have an upper bound on state size.** If so, how would we implement a token with a map of balances that can scale to billions of holders?

## Infinitely scalable balance map

The secret of infinite scalability on TON is sharding the data across multiple contracts. We can apply the parent-child design pattern to do just this.

In this example, we hold the balance of every holder in a separate child contract.

To transfer tokens, the owner sends the \`Transfer\` message to the child contract holding their own balance. This will cause the child to deploy its sibling - the child contract holding the recipient's balance - by sending it the \`InternalAddTokens\` message.

This example also handles gas efficiently. The excess gas from every operation is refunded to the original sender.`,S=`import "@stdlib/deploy";

struct Metadata {
    symbol: String;
    totalSupply: Int;
}

message Transfer {
    amount: Int as coins;
    to: Address;
}

// the token parent, mostly used to query general metadata and get children addresses
contract TokenParent with Deployable {
 
    symbol: String;
    totalSupply: Int as coins;

    init() {
        self.symbol = "SHIB";
        self.totalSupply = 500 * pow(10,9);
        self.mint(self.totalSupply, sender()); // mint the entire total supply to deployer
    }

    fun mint(amount: Int, to: Address) {
        let init: StateInit = initOf TokenChild(myAddress(), to);
        send(SendParameters{
            to: contractAddress(init),
            body: InternalAddTokens{amount: amount, origin: myAddress()}.toCell(),
            value: ton("0.03"),             // pay for the deployment and leave some TON in the child for storage
            mode: SendIgnoreErrors,
            code: init.code,                // deploy the child if needed
            data: init.data
        });
    }

    get fun metadata(): Metadata {
        return Metadata{symbol: self.symbol, totalSupply: self.totalSupply};
    }

    get fun childAddress(owner: Address): Address {
        return contractAddress(initOf TokenChild(myAddress(), owner));
    }
}

////////////////////////////////////////////////////////////////////////////
// child contract - the Transfer message is sent by users directly to a child

message InternalAddTokens {
    amount: Int as coins;
    origin: Address;
}

contract TokenChild {

    parent: Address;
    owner: Address;         // every child holds the balance of a different owner
    balance: Int as coins;  // this is the balance of the owner
 
    init(parent: Address, owner: Address) {
        self.parent = parent;
        self.owner = owner;
        self.balance = 0;
    }

    // sent by users to initiate a new transfer
    receive(msg: Transfer) {
        require(sender() == self.owner, "Access denied");
        require(self.balance >= msg.amount, "Insufficient balance");
        self.balance = self.balance - msg.amount;
        let init: StateInit = initOf TokenChild(self.parent, msg.to);
        send(SendParameters{
            to: contractAddress(init),
            body: InternalAddTokens{amount: msg.amount, origin: self.owner}.toCell(),
            value: ton("0.03"),             // pay for the deployment and leave some TON in the child for storage
            mode: SendIgnoreErrors,
            code: init.code,                // deploy the child if needed
            data: init.data
        });
        self.reply("transferred".asComment());
    }

    // internal message sent by one child to another to update balances
    receive(msg: InternalAddTokens) {
        if (msg.origin == self.parent) { // tokens originate in a mint
            require(sender() == self.parent, "Parent only");
        } else { // tokens originate in a Transfer
            require(sender() == contractAddress(initOf TokenChild(self.parent, msg.origin)), "Sibling only");
        }
        self.balance = self.balance + msg.amount;
    }

     get fun balance(): Int {
        return self.balance;
    }
}
`;function T(s){return e=>{let n=e;n.storeUint(2490013878,32),n.storeUint(s.queryId,64)}}function J(s){let e=s.readString(),n=s.readBigNumber();return{$$type:"Metadata",symbol:e,totalSupply:n}}async function C(){const s=a.Cell.fromBase64("te6ccgECFwEABAAAART/APSkE/S88sgLAQIBYgIDAqbQAdDTAwFxsKMB+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiFRQUwNvBPhhAvhi2zxa2zzy4ILI+EMBzH8BygBZyFjPFslYzAH6AsntVAsEAgEgBgcBigGSMH/gcCHXScIflTAg1wsf3oIQlGqYtrqOp9MfAYIQlGqYtrry4IHTPwExyAGCEK/5D1dYyx/LP8n4QgFwbds8f+AwcAUBOm1tIm6zmVsgbvLQgG8iAZEy4hAkcAMEgEJQI9s8EQIBIAgJAgEgExQCS7uzEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCI2zxY2zxsIYCwoCEbprPbPNs8bCKAsMAZD4Q/goWNs8cFnIcAHLAXMBywFwAcsAEszMyfkAyHIBywFwAcsAEsoHy//J0CDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IgPAUbtRNDUAfhj0gABmdQB0AH6AFlsEuAw+CjXCwqDCbry4InbPA0AAlwBJotFNISUKIIYdGpSiAD4QlIQ2zwOAvb4Q/goWNs8XHBZyHABywFzAcsBcAHLABLMzMn5AMhyAcsBcAHLABLKB8v/ydAg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCI+CgUyFmCEPgTyJtQA8sfAfoCASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFskPEADWAtD0BDBtAYEh7QGAEPQPb6Hy4IcBgSHtIgKAEPQXyAHI9ADJAcxwAcoAQANZINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiM8WASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFskBHIIJycOAWnJZfwZFVds8EQHKyHEBygFQBwHKAHABygJQBSDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFlAD+gJwAcpoI26zkX+TJG6z4pczMwFwAcoA4w0hbrOcfwHKAAEgbvLQgAHMlTFwAcoA4skB+wASAJh/AcoAyHABygBwAcoAJG6znX8BygAEIG7y0IBQBMyWNANwAcoA4iRus51/AcoABCBu8tCAUATMljQDcAHKAOJwAcoAAn8BygACyVjMALm7vRgnBc7D1dLK57HoTsOdZKhRtmgnCd1jUtK2R8syLTry398WI5gnAgVcAbgGdjlM5YOq5HJbLDgnAb1J3vlUWW8cdT094FWcMmgnCdl05as07LczoOlm2UZuikgCAUgVFgARsK+7UTQ0gABgAHWybuNDVpcGZzOi8vUW1RZmUyZHFYZWpxRlpoYWNKSlVSTVRBRXliUTdwakpmR0dNZjlzM3U2emY3Z4IA=="),e=a.Cell.fromBase64("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");let n=a.beginCell();n.storeRef(e),n.storeUint(0,1);const r=n.endCell();return{code:s,data:r}}const H={2:{message:"Stack undeflow"},3:{message:"Stack overflow"},4:{message:"Integer overflow"},5:{message:"Integer out of expected range"},6:{message:"Invalid opcode"},7:{message:"Type check error"},8:{message:"Cell overflow"},9:{message:"Cell underflow"},10:{message:"Dictionary error"},13:{message:"Out of gas error"},32:{message:"Method ID not found"},34:{message:"Action is invalid or not supported"},37:{message:"Not enough TON"},38:{message:"Not enough extra-currencies"},128:{message:"Null reference exception"},129:{message:"Invalid serialization prefix"},130:{message:"Invalid incoming message"},131:{message:"Constraints error"},132:{message:"Access denied"},133:{message:"Contract stopped"},134:{message:"Invalid argument"},135:{message:"Code of a contract was not found"},136:{message:"Invalid address"},137:{message:"Masterchain support is not enabled for this contract"},20537:{message:"Sibling only"},49469:{message:"Access denied"},54404:{message:"Parent only"},54615:{message:"Insufficient balance"}},M=[{name:"StateInit",header:null,fields:[{name:"code",type:{kind:"simple",type:"cell",optional:!1}},{name:"data",type:{kind:"simple",type:"cell",optional:!1}}]},{name:"Context",header:null,fields:[{name:"bounced",type:{kind:"simple",type:"bool",optional:!1}},{name:"sender",type:{kind:"simple",type:"address",optional:!1}},{name:"value",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"raw",type:{kind:"simple",type:"slice",optional:!1}}]},{name:"SendParameters",header:null,fields:[{name:"bounce",type:{kind:"simple",type:"bool",optional:!1}},{name:"to",type:{kind:"simple",type:"address",optional:!1}},{name:"value",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"mode",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"body",type:{kind:"simple",type:"cell",optional:!0}},{name:"code",type:{kind:"simple",type:"cell",optional:!0}},{name:"data",type:{kind:"simple",type:"cell",optional:!0}}]},{name:"Deploy",header:2490013878,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}}]},{name:"DeployOk",header:2952335191,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}}]},{name:"FactoryDeploy",header:1829761339,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}},{name:"cashback",type:{kind:"simple",type:"address",optional:!1}}]},{name:"Metadata",header:null,fields:[{name:"symbol",type:{kind:"simple",type:"string",optional:!1}},{name:"totalSupply",type:{kind:"simple",type:"int",optional:!1,format:257}}]},{name:"Transfer",header:1943715420,fields:[{name:"amount",type:{kind:"simple",type:"uint",optional:!1,format:"coins"}},{name:"to",type:{kind:"simple",type:"address",optional:!1}}]},{name:"InternalAddTokens",header:4162046107,fields:[{name:"amount",type:{kind:"simple",type:"uint",optional:!1,format:"coins"}},{name:"origin",type:{kind:"simple",type:"address",optional:!1}}]}],N=[{name:"metadata",arguments:[],returnType:{kind:"simple",type:"Metadata",optional:!1}},{name:"childAddress",arguments:[{name:"owner",type:{kind:"simple",type:"address",optional:!1}}],returnType:{kind:"simple",type:"address",optional:!1}}],Y=[{receiver:"internal",message:{kind:"typed",type:"Deploy"}}];class y{constructor(e,n){A(this,"address");A(this,"init");A(this,"abi",{types:[{name:"StateInit",header:null,fields:[]},{name:"Context",header:null,fields:[]},{name:"SendParameters",header:null,fields:[]},{name:"Deploy",header:2490013878,fields:[]},{name:"DeployOk",header:2952335191,fields:[]},{name:"FactoryDeploy",header:1829761339,fields:[]},{name:"Metadata",header:null,fields:[]},{name:"Transfer",header:1943715420,fields:[]},{name:"InternalAddTokens",header:4162046107,fields:[]}],types:M,getters:N,receivers:Y,errors:H});this.address=e,this.init=n}static async init(){return await C()}static async fromInit(){const e=await C(),n=a.contractAddress(0,e);return new y(n,e)}static fromAddress(e){return new y(e)}async send(e,n,r,t){let o=null;if(t&&typeof t=="object"&&!(t instanceof a.Slice)&&t.$$type==="Deploy"&&(o=a.beginCell().store(T(t)).endCell()),o===null)throw new Error("Invalid message type");await e.internal(n,{...r,body:o})}async getMetadata(e){let n=new a.TupleBuilder,r=(await e.get("metadata",n.build())).stack;return J(r)}async getChildAddress(e,n){let r=new a.TupleBuilder;return r.writeAddress(n),(await e.get("childAddress",r.build())).stack.readAddress()}}function F(s){return e=>{let n=e;n.storeUint(1943715420,32),n.storeCoins(s.amount),n.storeAddress(s.to)}}function P(s){return e=>{let n=e;n.storeUint(4162046107,32),n.storeCoins(s.amount),n.storeAddress(s.origin)}}function X(s){return e=>{let n=e;n.storeAddress(s.parent),n.storeAddress(s.owner)}}async function B(s,e){const n=a.Cell.fromBase64("te6ccgECGQEABRsAART/APSkE/S88sgLAQIBYgIDA3rQAdDTAwFxsKMB+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiFRQUwNvBPhhAvhi2zxVEts88uCCEwQFAgFYDxACugGSMH/gcCHXScIflTAg1wsf3iCCEHPavly6jrUw0x8BghBz2r5cuvLggfoA+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiBJsEts8f+CCEPgTyJu64wIwcAYHAJ7I+EMBzH8BygBVIFog10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIzxZYINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiM8WAfoCye1UAsSCAME9+EJSUMcF8vSCANVXXb7y9FEhofhDVCBU2zxccFnIcAHLAXMBywFwAcsAEszMyfkAyHIBywFwAcsAEsoHy//J0CDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IhRNQ4IAWLTHwGCEPgTyJu68uCB+gD6QAEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIEmwSDQOKyFmCEPgTyJtQA8sfAfoCASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFsmCCcnDgFpyWX8GRVXbPIj4QgF/bds8CwkKAB4AAAAAdHJhbnNmZXJyZWQBOm1tIm6zmVsgbvLQgG8iAZEy4hAkcAMEgEJQI9s8CwHKyHEBygFQBwHKAHABygJQBSDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFlAD+gJwAcpoI26zkX+TJG6z4pczMwFwAcoA4w0hbrOcfwHKAAEgbvLQgAHMlTFwAcoA4skB+wAMAJh/AcoAyHABygBwAcoAJG6znX8BygAEIG7y0IBQBMyWNANwAcoA4iRus51/AcoABCBu8tCAUATMljQDcAHKAOJwAcoAAn8BygACyVjMAdBTQMcFnTCCANSE+EJSUMcF8vSO0YFQOfhDVCBj2zxwWchwAcsBcwHLAXABywASzMzJ+QDIcgHLAXABywASygfL/8nQINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiPhCxwXy9OKgfw4A1gLQ9AQwbQGBIe0BgBD0D2+h8uCHAYEh7SICgBD0F8gByPQAyQHMcAHKAEADWSDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFgEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIzxbJAgEgERICAUgXGAIRttgbZ5tnjYYwExQAubd6ME4LnYerpZXPY9CdhzrJUKNs0E4TusalpWyPlmRadeW/vixHME4ECrgDcAzscpnLB1XI5LZYcE4DepO98qiy3jjqenvAqzhk0E4TsunLVmnZbmdB0s2yjN0UkAG87UTQ1AH4Y9IAAY5G+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiAH6QAEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIAfoAVSBsE+D4KNcLCoMJuvLgiRUAAiABivpAASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IgB+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiBIC0QHbPBYAAnAAEbCvu1E0NIAAYAB1sm7jQ1aXBmczovL1FtYUhHdEZzWllSbURWOEFTQ0JySDM4VGpUYWkyRXJSdk5jZ1hXV1dWbmRneG+CA="),r=a.Cell.fromBase64("te6cckECGwEABSUAAQHAAQEFoEPbAgEU/wD0pBP0vPLICwMCAWIMBAIBWAgFAgFIBwYAdbJu40NWlwZnM6Ly9RbWFIR3RGc1pZUm1EVjhBU0NCckgzOFRqVGFpMkVyUnZOY2dYV1dXVm5kZ3hvggABGwr7tRNDSAAGACASAKCQC5t3owTgudh6ullc9j0J2HOslQo2zQThO6xqWlbI+WZFp15b++LEcwTgQKuANwDOxymcsHVcjktlhwTgN6k73yqLLeOOp6e8CrOGTQThOy6ctWadluZ0HSzbKM3RSQAhG22Btnm2eNhjAYCwACIAN60AHQ0wMBcbCjAfpAASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IhUUFMDbwT4YQL4Yts8VRLbPPLgghgODQCeyPhDAcx/AcoAVSBaINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiM8WWCDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFgH6AsntVAK6AZIwf+BwIddJwh+VMCDXCx/eIIIQc9q+XLqOtTDTHwGCEHPavly68uCB+gD6QAEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIEmwS2zx/4IIQ+BPIm7rjAjBwEQ8BYtMfAYIQ+BPIm7ry4IH6APpAASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IgSbBIQAdBTQMcFnTCCANSE+EJSUMcF8vSO0YFQOfhDVCBj2zxwWchwAcsBcwHLAXABywASzMzJ+QDIcgHLAXABywASygfL/8nQINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiPhCxwXy9OKgfxcCxIIAwT34QlJQxwXy9IIA1VddvvL0USGh+ENUIFTbPFxwWchwAcsBcwHLAXABywASzMzJ+QDIcgHLAXABywASygfL/8nQINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiFE1FxIDishZghD4E8ibUAPLHwH6AgEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIzxbJggnJw4Bacll/BkVV2zyI+EIBf23bPBUUEwE6bW0ibrOZWyBu8tCAbyIBkTLiECRwAwSAQlAj2zwVAB4AAAAAdHJhbnNmZXJyZWQByshxAcoBUAcBygBwAcoCUAUg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIzxZQA/oCcAHKaCNus5F/kyRus+KXMzMBcAHKAOMNIW6znH8BygABIG7y0IABzJUxcAHKAOLJAfsAFgCYfwHKAMhwAcoAcAHKACRus51/AcoABCBu8tCAUATMljQDcAHKAOIkbrOdfwHKAAQgbvLQgFAEzJY0A3ABygDicAHKAAJ/AcoAAslYzADWAtD0BDBtAYEh7QGAEPQPb6Hy4IcBgSHtIgKAEPQXyAHI9ADJAcxwAcoAQANZINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiM8WASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IjPFskBvO1E0NQB+GPSAAGORvpAASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IgB+kABINdJgQELuvLgiCDXCwoggQT/uvLQiYMJuvLgiAH6AFUgbBPg+CjXCwqDCbry4IkZAYr6QAEg10mBAQu68uCIINcLCiCBBP+68tCJgwm68uCIAfpAASDXSYEBC7ry4Igg1wsKIIEE/7ry0ImDCbry4IgSAtEB2zwaAAJwFw4Paw==");let t=a.beginCell();t.storeRef(r),t.storeUint(0,1),X({$$type:"TokenChild_init_args",parent:s,owner:e})(t);const o=t.endCell();return{code:n,data:o}}const z={2:{message:"Stack undeflow"},3:{message:"Stack overflow"},4:{message:"Integer overflow"},5:{message:"Integer out of expected range"},6:{message:"Invalid opcode"},7:{message:"Type check error"},8:{message:"Cell overflow"},9:{message:"Cell underflow"},10:{message:"Dictionary error"},13:{message:"Out of gas error"},32:{message:"Method ID not found"},34:{message:"Action is invalid or not supported"},37:{message:"Not enough TON"},38:{message:"Not enough extra-currencies"},128:{message:"Null reference exception"},129:{message:"Invalid serialization prefix"},130:{message:"Invalid incoming message"},131:{message:"Constraints error"},132:{message:"Access denied"},133:{message:"Contract stopped"},134:{message:"Invalid argument"},135:{message:"Code of a contract was not found"},136:{message:"Invalid address"},137:{message:"Masterchain support is not enabled for this contract"},20537:{message:"Sibling only"},49469:{message:"Access denied"},54404:{message:"Parent only"},54615:{message:"Insufficient balance"}},U=[{name:"StateInit",header:null,fields:[{name:"code",type:{kind:"simple",type:"cell",optional:!1}},{name:"data",type:{kind:"simple",type:"cell",optional:!1}}]},{name:"Context",header:null,fields:[{name:"bounced",type:{kind:"simple",type:"bool",optional:!1}},{name:"sender",type:{kind:"simple",type:"address",optional:!1}},{name:"value",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"raw",type:{kind:"simple",type:"slice",optional:!1}}]},{name:"SendParameters",header:null,fields:[{name:"bounce",type:{kind:"simple",type:"bool",optional:!1}},{name:"to",type:{kind:"simple",type:"address",optional:!1}},{name:"value",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"mode",type:{kind:"simple",type:"int",optional:!1,format:257}},{name:"body",type:{kind:"simple",type:"cell",optional:!0}},{name:"code",type:{kind:"simple",type:"cell",optional:!0}},{name:"data",type:{kind:"simple",type:"cell",optional:!0}}]},{name:"Deploy",header:2490013878,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}}]},{name:"DeployOk",header:2952335191,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}}]},{name:"FactoryDeploy",header:1829761339,fields:[{name:"queryId",type:{kind:"simple",type:"uint",optional:!1,format:64}},{name:"cashback",type:{kind:"simple",type:"address",optional:!1}}]},{name:"Metadata",header:null,fields:[{name:"symbol",type:{kind:"simple",type:"string",optional:!1}},{name:"totalSupply",type:{kind:"simple",type:"int",optional:!1,format:257}}]},{name:"Transfer",header:1943715420,fields:[{name:"amount",type:{kind:"simple",type:"uint",optional:!1,format:"coins"}},{name:"to",type:{kind:"simple",type:"address",optional:!1}}]},{name:"InternalAddTokens",header:4162046107,fields:[{name:"amount",type:{kind:"simple",type:"uint",optional:!1,format:"coins"}},{name:"origin",type:{kind:"simple",type:"address",optional:!1}}]}],K=[{name:"balance",arguments:[],returnType:{kind:"simple",type:"int",optional:!1,format:257}}],W=[{receiver:"internal",message:{kind:"typed",type:"Transfer"}},{receiver:"internal",message:{kind:"typed",type:"InternalAddTokens"}}];class d{constructor(e,n){A(this,"address");A(this,"init");A(this,"abi",{types:[{name:"StateInit",header:null,fields:[]},{name:"Context",header:null,fields:[]},{name:"SendParameters",header:null,fields:[]},{name:"Deploy",header:2490013878,fields:[]},{name:"DeployOk",header:2952335191,fields:[]},{name:"FactoryDeploy",header:1829761339,fields:[]},{name:"Metadata",header:null,fields:[]},{name:"Transfer",header:1943715420,fields:[]},{name:"InternalAddTokens",header:4162046107,fields:[]}],types:U,getters:K,receivers:W,errors:z});this.address=e,this.init=n}static async init(e,n){return await B(e,n)}static async fromInit(e,n){const r=await B(e,n),t=a.contractAddress(0,r);return new d(t,r)}static fromAddress(e){return new d(e)}async send(e,n,r,t){let o=null;if(t&&typeof t=="object"&&!(t instanceof a.Slice)&&t.$$type==="Transfer"&&(o=a.beginCell().store(F(t)).endCell()),t&&typeof t=="object"&&!(t instanceof a.Slice)&&t.$$type==="InternalAddTokens"&&(o=a.beginCell().store(P(t)).endCell()),o===null)throw new Error("Invalid message type");await e.internal(n,{...r,body:o})}async getBalance(e){let n=new a.TupleBuilder;return(await e.get("balance",n.build())).stack.readBigNumber()}}function O(s,e,n){let r;L(s,I,i=>n(6,r=i));let t,o,g,l,m,p;return k(I,r={markdown:D,tactCode:S,deploy:async()=>{t=await v.Blockchain.create();const i=await t.treasury("deployer");o=i.getSender();const c=await t.treasury("another");g=c.getSender(),l=t.openContract(await y.fromInit()),m=t.openContract(await d.fromInit(l.address,o.address)),p=t.openContract(await d.fromInit(l.address,g.address));const f={[i.address.toString()]:"deployer",[c.address.toString()]:"user2",[l.address.toString()]:"TokenParent",[m.address.toString()]:"TokenChild(deployer)",[p.address.toString()]:"TokenChild(user2)"};return[[l,m,p],f,[await l.send(i.getSender(),{value:a.toNano(1)},{$$type:"Deploy",queryId:0n})]]},messages:{"Transfer{100,user2} (from deployer)":async()=>{const i=await l.getChildAddress(o.address);return[await t.openContract(await d.fromAddress(i)).send(o,{value:a.toNano(1)},{$$type:"Transfer",amount:a.toNano(100),to:g.address})]},"Transfer{100,deployer} (from user2)":async()=>{const i=await l.getChildAddress(g.address);return[await t.openContract(await d.fromAddress(i)).send(g,{value:a.toNano(1)},{$$type:"Transfer",amount:a.toNano(100),to:o.address})]}},getters:{metadata:async()=>await l.getMetadata(),"balance(childAddress(deployer))":async()=>{const i=await l.getChildAddress(o.address);return await t.openContract(await d.fromAddress(i)).getBalance()},"balance(childAddress(user2))":async()=>{const i=await l.getChildAddress(g.address);return await t.openContract(await d.fromAddress(i)).getBalance()}},prev:u(import.meta.url).prev,next:u(import.meta.url).next},r),[]}class j extends E{constructor(e){super(),Q(this,e,O,null,b,{})}}export{j as default};
